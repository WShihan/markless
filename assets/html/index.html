{{ define "style"}}
<link rel="stylesheet" href="{{$.Env.BaseURL}}/static/css/index.css" />
<script defer src="{{$.Env.BaseURL}}/static/js/link_filter.js"></script>
<script defer src="{{$.Env.BaseURL}}/static/js/img_lazy.js"></script>
{{ end }} 

{{ define "content"}}
  <div class="tag-dock">
    <div class="dock-header">
      <svg t="1726691362191" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1921" width="200" height="200"><path d="M290.17945 125.041878M928.817686 524.408611C798.773887 394.33309 668.763858 264.224824 538.56861 134.299729c-16.504906-16.463973-32.479739-33.327036-51.724035-47.195905-20.039405-14.436804-40.845267-22.820752-65.433268-22.706141-43.686988 0.209778-87.37193 0.060375-131.057895 0.060375 0 0.01228 0 0.030699-0.00614 0.047072-45.561685 0-91.13258-0.399089-136.690172 0.10847-51.02921 0.567935-90.073458 40.454364-90.133833 91.478458-0.094144 90.289376-0.077771 180.585915 0.071631 270.879384 0.013303 7.040347 0.851391 14.201443 2.325975 21.090341 5.334495 24.89704 20.547988 44.6315 37.609573 61.802578 140.086525 140.993175 280.764522 281.403065 421.418982 421.836491 37.090756 37.024242 98.471732 36.777625 135.612631-0.292666 89.947592-89.769536 179.824575-179.613774 269.462105-269.701558 7.099698-7.127328 13.276375-15.757892 17.809621-24.740474C966.804858 599.405699 958.935634 554.523489 928.817686 524.408611zM375.604028 468.162586c-49.227168-0.157589-89.421612-40.580231-88.944751-89.463568 0.487094-49.28959 40.563858-88.722694 89.958848-88.51394 48.611138 0.211824 88.530312 40.388872 88.477101 89.059362C465.04406 428.368254 424.848593 468.313012 375.604028 468.162586zM376.737852 438.488753" fill="#1296db" p-id="1922"></path></svg>
      <span>{{i18n "page.all.tag" $.Page.Lang}}</span>
    </div>
    {{ range  .TagStastic }}
    <div class="pair">
      <a class="icon-btn" href="?tag={{.Name}}">{{.Name}}</a>
      <span class="count">
        <a class="icon" href="{{$.Env.BaseURL}}/tag/edit/{{.ID}}?id={{.ID}}">{{.Count}}</a>
      </span>
    </div>
    {{ end }}
  </div>
  <div class="search">
    <input id="keyword" type="text"  value="{{.Search.Keyword}}" placeholder="{{i18n "page.all.search-tip" $.Page.Lang}}">
    <button id="link-filter-btn" class="submit"  type="submit">
      <svg t="1726445320394" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="980" width="200" height="200"><path d="M426.666667 853.333333C191.146667 853.333333 0 662.442667 0 426.666667S191.146667 0 426.666667 0s426.666667 190.890667 426.666666 426.666667-191.146667 426.666667-426.666666 426.666666z m-4.053334-89.386666a341.333333 341.333333 0 1 0 0-682.666667 341.333333 341.333333 0 0 0 0 682.666667z" fill="#e6e6e6" p-id="981"></path><path d="M695.168 755.498667a42.666667 42.666667 0 0 1 60.330667-60.330667l256 256a42.666667 42.666667 0 0 1-60.330667 60.330667l-256-256z" fill="#e6e6e6" p-id="982"></path></svg>
    </button>
  </div>
  <div class="link-btns">
    <a href="{{$.Env.BaseURL}}/link/mark/read?v=0"  class="icon">{{i18n "link.btn.mark-as-read" $.Page.Lang}}</a>
    <a href="{{$.Env.BaseURL}}/link/mark/unread?v=0" class="icon">{{i18n "link.btn.mark-as-unread" $.Page.Lang}}</a>
  </div>
  <div class="links" onclick="linkOperate(event)">
    {{ range .Data }}
    <div class="link">
      <div class="link-header">
        <img class="favicon img-lazy" data-src="{{.Icon}}" alt="icon" />
        <a class="url icon" target="_blank" data-id="{{.ID}}" data-url="{{.Url}}" data-operate="view" rel="noopener">
          <span class="disable">{{ .Title }}</span>
        </a>
      </div>
      <div class="link-desc">
        <span class="link-desc-text">{{.CreateTime | TimeFMT }}<span class="gap">｜</span>{{.Desc}}</span>
      </div>
      <div class="link-tags">
        {{ range .Tags }}
        <a class="tag-item icon" href="?tag={{.Name}}">#{{.Name}}</a>
        {{ end }}
      </div>
      <div class="link-opts" data-id="{{.ID}}" data-read="{{.Read}}">
        {{if .Read}}
        <a  class="opt-item icon-btn" data-operate="unread" data-id="{{.ID}}"  title="{{i18n "link.btn.delete" $.Page.Lang}}">
          <svg t="1726443111970" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1157" width="200" height="200"><path d="M448.2 185.5h110.1c14.5 0 27.3-12.9 27.3-27.3 0-14.5-12.9-27.3-27.3-27.3H448.2c-14.5 0-27.3 12.9-27.3 27.3s11.2 27.3 27.3 27.3z m0 0" fill="#1296db" p-id="1158"></path><path d="M558.4 189.5H448.2c-17.6 0-31.3-13.8-31.3-31.3 0-16.7 14.6-31.3 31.3-31.3h110.1c16.7 0 31.3 14.6 31.3 31.3 0.1 16.6-14.6 31.3-31.2 31.3z m-110.2-54.7c-12.2 0-23.3 11.1-23.3 23.3 0 11.5 8.7 23.3 23.3 23.3h110.1c12.2 0 23.3-11.1 23.3-23.3s-11.1-23.3-23.3-23.3H448.2zM464.9 677.1c8.2 0 16.4-3.1 22.7-9.4L729.3 426c12.5-12.5 12.5-32.8 0-45.4-12.5-12.5-32.9-12.5-45.4 0l-219 219-98.2-98.2c-12.5-12.5-32.8-12.5-45.4 0-12.5 12.5-12.5 32.8 0 45.4l120.8 120.8c6.4 6.4 14.6 9.5 22.8 9.5z m0 0" fill="#1296db" p-id="1159"></path><path d="M464.9 678.1c-8.8 0-17.1-3.4-23.4-9.7L320.7 547.6c-6.2-6.2-9.7-14.6-9.7-23.4s3.4-17.1 9.7-23.4c6.2-6.3 14.6-9.7 23.4-9.7 8.8 0 17.1 3.4 23.4 9.7l97.4 97.4L683.2 380c6.2-6.2 14.6-9.7 23.4-9.7 8.8 0 17.2 3.4 23.4 9.7 12.9 12.9 12.9 33.9 0 46.8L488.3 668.4c-6.2 6.3-14.6 9.7-23.4 9.7z m-120.8-185c-8.3 0-16.1 3.2-22 9.1-5.9 5.9-9.1 13.7-9.1 22s3.2 16.1 9.1 22L442.9 667c5.9 5.9 13.7 9.1 22 9.1s16.1-3.2 22-9.1l241.7-241.7c12.1-12.1 12.1-31.8 0-44-5.9-5.9-13.7-9.1-22-9.1s-16.1 3.2-22 9.1L464.9 601.1 366 502.2c-5.8-5.9-13.6-9.1-21.9-9.1z" fill="#1296db" p-id="1160"></path><path d="M797.6 895.7H219.7c-53.3 0-96.7-43.4-96.7-96.7V224.5c0-53.3 43.4-96.7 96.7-96.7h133.1v60H219.7c-20.2 0-36.7 16.5-36.7 36.7V799c0 20.2 16.5 36.7 36.7 36.7h577.9c20.2 0 36.7-16.5 36.7-36.7V224.5c0-20.2-16.5-36.7-36.7-36.7H652.9v-60h144.7c53.3 0 96.7 43.4 96.7 96.7V799c0 53.4-43.4 96.7-96.7 96.7z" fill="#1296db" p-id="1161"></path><path d="M354.6 187.8H217.5c-16.6 0-30-13.4-30-30s13.4-30 30-30h137.1c16.6 0 30 13.4 30 30s-13.5 30-30 30z" fill="#1296db" p-id="1162"></path><path d="M795.7 187.8H647.6c-16.6 0-30-13.4-30-30s13.4-30 30-30h148.2c16.6 0 30 13.4 30 30s-13.5 30-30.1 30z" fill="#1296db" p-id="1163"></path></svg>
          <span class="label">{{i18n "link.btn.unread" $.Page.Lang}}</span>
        </a><span class="gap">｜</span>
        {{ else }}
        <a  class="opt-item icon-btn" data-operate="read" data-id="{{.ID}}"  title="{{i18n "link.btn.delete" $.Page.Lang}}">
          <svg t="1726443111970" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1157" width="200" height="200"><path d="M448.2 185.5h110.1c14.5 0 27.3-12.9 27.3-27.3 0-14.5-12.9-27.3-27.3-27.3H448.2c-14.5 0-27.3 12.9-27.3 27.3s11.2 27.3 27.3 27.3z m0 0" fill="#1296db" p-id="1158"></path><path d="M558.4 189.5H448.2c-17.6 0-31.3-13.8-31.3-31.3 0-16.7 14.6-31.3 31.3-31.3h110.1c16.7 0 31.3 14.6 31.3 31.3 0.1 16.6-14.6 31.3-31.2 31.3z m-110.2-54.7c-12.2 0-23.3 11.1-23.3 23.3 0 11.5 8.7 23.3 23.3 23.3h110.1c12.2 0 23.3-11.1 23.3-23.3s-11.1-23.3-23.3-23.3H448.2zM464.9 677.1c8.2 0 16.4-3.1 22.7-9.4L729.3 426c12.5-12.5 12.5-32.8 0-45.4-12.5-12.5-32.9-12.5-45.4 0l-219 219-98.2-98.2c-12.5-12.5-32.8-12.5-45.4 0-12.5 12.5-12.5 32.8 0 45.4l120.8 120.8c6.4 6.4 14.6 9.5 22.8 9.5z m0 0" fill="#1296db" p-id="1159"></path><path d="M464.9 678.1c-8.8 0-17.1-3.4-23.4-9.7L320.7 547.6c-6.2-6.2-9.7-14.6-9.7-23.4s3.4-17.1 9.7-23.4c6.2-6.3 14.6-9.7 23.4-9.7 8.8 0 17.1 3.4 23.4 9.7l97.4 97.4L683.2 380c6.2-6.2 14.6-9.7 23.4-9.7 8.8 0 17.2 3.4 23.4 9.7 12.9 12.9 12.9 33.9 0 46.8L488.3 668.4c-6.2 6.3-14.6 9.7-23.4 9.7z m-120.8-185c-8.3 0-16.1 3.2-22 9.1-5.9 5.9-9.1 13.7-9.1 22s3.2 16.1 9.1 22L442.9 667c5.9 5.9 13.7 9.1 22 9.1s16.1-3.2 22-9.1l241.7-241.7c12.1-12.1 12.1-31.8 0-44-5.9-5.9-13.7-9.1-22-9.1s-16.1 3.2-22 9.1L464.9 601.1 366 502.2c-5.8-5.9-13.6-9.1-21.9-9.1z" fill="#1296db" p-id="1160"></path><path d="M797.6 895.7H219.7c-53.3 0-96.7-43.4-96.7-96.7V224.5c0-53.3 43.4-96.7 96.7-96.7h133.1v60H219.7c-20.2 0-36.7 16.5-36.7 36.7V799c0 20.2 16.5 36.7 36.7 36.7h577.9c20.2 0 36.7-16.5 36.7-36.7V224.5c0-20.2-16.5-36.7-36.7-36.7H652.9v-60h144.7c53.3 0 96.7 43.4 96.7 96.7V799c0 53.4-43.4 96.7-96.7 96.7z" fill="#1296db" p-id="1161"></path><path d="M354.6 187.8H217.5c-16.6 0-30-13.4-30-30s13.4-30 30-30h137.1c16.6 0 30 13.4 30 30s-13.5 30-30 30z" fill="#1296db" p-id="1162"></path><path d="M795.7 187.8H647.6c-16.6 0-30-13.4-30-30s13.4-30 30-30h148.2c16.6 0 30 13.4 30 30s-13.5 30-30.1 30z" fill="#1296db" p-id="1163"></path></svg>
          <span class="label">{{i18n "link.btn.read" $.Page.Lang}}</span>
        </a><span class="gap">｜</span>
        {{end}}

        <a class="opt-item icon-btn" data-operate="edit" data-id="{{.ID}}"  title="{{i18n "link.btn.edit" $.Page.Lang}}">
          <svg t="1726443086865" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="949" width="200" height="200"><path d="M834.3 705.7c0 82.2-66.8 149-149 149H325.9c-82.2 0-149-66.8-149-149V346.4c0-82.2 66.8-149 149-149h129.8v-42.7H325.9c-105.7 0-191.7 86-191.7 191.7v359.3c0 105.7 86 191.7 191.7 191.7h359.3c105.7 0 191.7-86 191.7-191.7V575.9h-42.7v129.8z" fill="#1296db" p-id="950"></path><path d="M889.7 163.4c-22.9-22.9-53-34.4-83.1-34.4s-60.1 11.5-83.1 34.4L312 574.9c-16.9 16.9-27.9 38.8-31.2 62.5l-19 132.8c-1.6 11.4 7.3 21.3 18.4 21.3 0.9 0 1.8-0.1 2.7-0.2l132.8-19c23.7-3.4 45.6-14.3 62.5-31.2l411.5-411.5c45.9-45.9 45.9-120.3 0-166.2zM362 585.3L710.3 237 816 342.8 467.8 691.1 362 585.3zM409.7 730l-101.1 14.4L323 643.3c1.4-9.5 4.8-18.7 9.9-26.7L436.3 720c-8 5.2-17.1 8.7-26.6 10z m449.8-430.7l-13.3 13.3-105.7-105.8 13.3-13.3c14.1-14.1 32.9-21.9 52.9-21.9s38.8 7.8 52.9 21.9c29.1 29.2 29.1 76.7-0.1 105.8z" fill="#1296db" p-id="951"></path></svg>
          <span class="label">{{i18n "link.btn.edit" $.Page.Lang}}</span>
        </a><span class="gap">｜</span>
        <a data-id="{{.ID}}"  data-operate="delete"  class="opt-item icon-btn" title="{{i18n "link.btn.delete" $.Page.Lang}}">
          <svg t="1726443127562" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1369" width="200" height="200"><path d="M684.56 158H339.44a32 32 0 0 1 0-64h345.12a32 32 0 0 1 0 64zM522.52 736.72a32 32 0 0 1-32-32v-240a32 32 0 1 1 64 0v240a32 32 0 0 1-32 32zM903.42 299H120.58a32 32 0 1 1 0-64h782.84a32 32 0 1 1 0 64z" p-id="1370" fill="#1296db"></path><path d="M669.02 964h-314a188.76 188.76 0 0 1-188.54-188.54V410.1a32 32 0 0 1 64 0v365.36A124.68 124.68 0 0 0 354.98 900h314a124.68 124.68 0 0 0 124.54-124.54V410.1a32 32 0 1 1 64 0v365.36A188.76 188.76 0 0 1 669.02 964z" p-id="1371" fill="#1296db"></path></svg>
          <span class="label">{{i18n "link.btn.delete" $.Page.Lang}}</span>
        </a>
      </div>
    </div>
    {{ end }}
  </div>
  <div class="move">
    {{ if eq .Search.Page 0 }}
    <span  class="icon disable" >{{i18n "page.all.pre" $.Page.Lang}}</span>
    {{ else }}
    <span id="pre-page" class="icon">{{i18n "page.all.pre" $.Page.Lang}}</span>
    {{ end }}
    <a id="current-page" data-page="{{.Search.Page}}" class="current icon">{{i18n "page.all.current-tip" $.Page.Lang}}{{.Search.Page | Increase}} | {{i18n "page.all.per-page" $.Page.Lang}} {{.Search.Limit }} | {{i18n "page.all.total-page" $.Page.Lang}} {{.Search.Pages}}</a>
    <span  id="next-page" class="icon" >{{i18n "page.all.next" $.Page.Lang}}</span>
  </div>
  <script defer>
  function linkOperate(evt) {
    console.log(evt.target);
    let operate = evt.target.getAttribute('data-operate');
    const root = window.baseURL;
    if (operate == null) return;
    else {
      evt.preventDefault();
      const id = evt.target.getAttribute('data-id');
      if (operate == 'edit') {
        window.location.href = root + `/link/edit/${id}`;
      } else if (operate == 'delete') {
        if (confirm('{{ i18n "confirm.delete" $.Page.Lang }}?')) {
          fetch(root + `/api/link/delete/${id}`, {
            method: 'GET',
            cache: 'no-cache',
            credentials: 'include',
          }).then(res => {
            window.location.reload();
          });
        }
      } else if (operate == 'read') {
        fetch(root + `/api/link/read/${id}`, {
          method: 'GET',
          cache: 'no-cache',
          credentials: 'include',
        }).then(res => {
          evt.target.lastElementChild.innerText = '{{ i18n "link.btn.unread" $.Page.Lang }}';
          evt.target.setAttribute('data-operate', 'unread');
        });
      } else if (operate == 'unread') {
        fetch(root + `/api/link/unread/${id}`, {
          method: 'GET',
          cache: 'no-cache',
          credentials: 'include',
        }).then(res => {
          evt.target.lastElementChild.innerText = '{{ i18n "link.btn.read" $.Page.Lang }}';
          evt.target.setAttribute('data-operate', 'read');
        });
      } else if (operate == 'view') {
        fetch(root + `/api/link/read/${id}`, {
          method: 'GET',
          cache: 'no-cache',
          credentials: 'include',
        }).then(res => {});
        const url = evt.target.getAttribute('data-url');
        window.open(url);
      }
    }
}

  </script>
{{ end }}
